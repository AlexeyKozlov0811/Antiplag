{% extends "app/base.html" %}

{% block content %}
    {% for i in text %}
        <div class="wrapper">
            {% if i.author == "Unknown" %}
                <a class="text_source" href="{{ i.source }}">Джерело:{{ i.source }}</a>
            {% elif i.author != user.username %}
                <p> class="text_source">Автор: {{ i.author }}</p>
            {% endif %}
            <p class="text_upload_date">Дата завантаження: {{ i.upload_date }}</p>
            {% if i.uniqueness == -1.0 %}
                <p>Унікальність = не перевірено</p>
            {% else %}
                <p>Унікальність = {{i.uniqueness}}</p>
            {% endif %}
            {% if i.get_sources != -1.0 %}
                <div class="sources">Джерела:</div>
                {% for source in i.get_sources %}
                    <button class="get_source first_text_button" value="{{source}}">Порівняти з текстом № {{source}}</button>
                    <a class="second_text_button" href="http://{{ request.get_host }}/text/{{source}}/">Переглянути текст №{{source}} детальніше</a>
                {% endfor %}
            {% endif %}

            <div class="first_text">
                <p class="detailed_text_area">{{i.content}}</p>
            </div>
            <div class="second_text">
                <p id="second_text_area" class="detailed_text_area"></p>
            </div>
        </div>
    {% endfor %}
{% endblock %}

{% block scripts %}
<script>

        let patterns = [
            {text: " 1!_!_!1 ", classes: ['orange'], new_text: `<span class="orange">`},
            {text: " 2!_!_!2 ", classes: ['orange'], new_text: `</span>`},
        ];

        url = document.location.href.split('/');
        id = url[url.length-2]
        $.ajax({
            type: 'GET',
            async: true,
            url: '/highlight_text/' + id + '/',
            data: "",
            success: function(data) {
                if (data['text'][0] !== undefined){
                    patterns.unshift({text: data['text'][0], classes: ['orange'], new_text: ``})
                    console.log(patterns);
                    let text = document.body.innerHTML;

                }
            },
            dataType: 'json',
        });




</script>
{% endblock %}


